# –°–∫—Ä–∏–ø—Ç —Å–±–æ—Ä–∫–∏ —Ä–µ–ª–∏–∑–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ø–Ω–¥–µ–∫—Å –ú—É–∑—ã–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞
# —Å —É–ª—É—á—à–µ–Ω–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–æ–π –ø—Ä–æ–±–ª–µ–º

Write-Host "üéµ –°–±–æ—Ä–∫–∞ —Ä–µ–ª–∏–∑–Ω–æ–π –≤–µ—Ä—Å–∏–∏ –Ø–Ω–¥–µ–∫—Å –ú—É–∑—ã–∫–∞ –∫–ª–∏–µ–Ω—Ç–∞..." -ForegroundColor Green

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Node.js
try {
    $nodeVersion = node --version
    Write-Host "‚úÖ Node.js –Ω–∞–π–¥–µ–Ω: $nodeVersion" -ForegroundColor Green
} catch {
    Write-Host "‚ùå Node.js –Ω–µ –Ω–∞–π–¥–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Node.js –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞." -ForegroundColor Red
    exit 1
}

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ npm
try {
    $npmVersion = npm --version
    Write-Host "‚úÖ npm –Ω–∞–π–¥–µ–Ω: $npmVersion" -ForegroundColor Green
} catch {
    Write-Host "‚ùå npm –Ω–µ –Ω–∞–π–¥–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ npm –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞." -ForegroundColor Red
    exit 1
}

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Rust
try {
    $rustVersion = rustc --version
    Write-Host "‚úÖ Rust –Ω–∞–π–¥–µ–Ω: $rustVersion" -ForegroundColor Green
} catch {
    Write-Host "‚ùå Rust –Ω–µ –Ω–∞–π–¥–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Rust –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞." -ForegroundColor Red
    exit 1
}

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ Cargo
try {
    $cargoVersion = cargo --version
    Write-Host "‚úÖ Cargo –Ω–∞–π–¥–µ–Ω: $cargoVersion" -ForegroundColor Green
} catch {
    Write-Host "‚ùå Cargo –Ω–µ –Ω–∞–π–¥–µ–Ω. –£—Å—Ç–∞–Ω–æ–≤–∏—Ç–µ Cargo –∏ –ø–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–Ω–æ–≤–∞." -ForegroundColor Red
    exit 1
}

Write-Host "`nüì¶ –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏..." -ForegroundColor Yellow
npm install

if ($LASTEXITCODE -ne 0) {
    Write-Host "‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π" -ForegroundColor Red
    exit 1
}

Write-Host "‚úÖ –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã" -ForegroundColor Green

Write-Host "`nüî® –°–æ–±–∏—Ä–∞–µ–º —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥..." -ForegroundColor Yellow
npm run build

if ($LASTEXITCODE -ne 0) {
    Write-Host "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞" -ForegroundColor Red
    exit 1
}

Write-Host "‚úÖ –§—Ä–æ–Ω—Ç–µ–Ω–¥ —Å–æ–±—Ä–∞–Ω" -ForegroundColor Green

Write-Host "`nüöÄ –°–æ–±–∏—Ä–∞–µ–º Tauri –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ..." -ForegroundColor Yellow
cargo tauri build --release

if ($LASTEXITCODE -ne 0) {
    Write-Host "‚ùå –û—à–∏–±–∫–∞ —Å–±–æ—Ä–∫–∏ Tauri –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" -ForegroundColor Red
    exit 1
}

Write-Host "‚úÖ Tauri –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–±—Ä–∞–Ω–æ" -ForegroundColor Green

Write-Host "`nüìÅ –ü—Ä–æ–≤–µ—Ä—è–µ–º —Å–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã..." -ForegroundColor Yellow

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —Å–æ–±—Ä–∞–Ω–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
$appPath = "src-tauri/target/release/yandex-music-client.exe"
if (Test-Path $appPath) {
    $fileSize = (Get-Item $appPath).Length / 1MB
    Write-Host "‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å–æ–∑–¥–∞–Ω–æ: $appPath (${fileSize:F2} MB)" -ForegroundColor Green
} else {
    Write-Host "‚ùå –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ" -ForegroundColor Red
}

# –ü—Ä–æ–≤–µ—Ä—è–µ–º –Ω–∞–ª–∏—á–∏–µ —É—Å—Ç–∞–Ω–æ–≤—â–∏–∫–∞
$installerPath = "src-tauri/target/release/bundle/msi/yandex-music-client_0.1.0_x64_en-US.msi"
if (Test-Path $installerPath) {
    $fileSize = (Get-Item $installerPath).Length / 1MB
    Write-Host "‚úÖ –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ —Å–æ–∑–¥–∞–Ω: $installerPath (${fileSize:F2} MB)" -ForegroundColor Green
} else {
    Write-Host "‚ö†Ô∏è –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫ –Ω–µ –Ω–∞–π–¥–µ–Ω (–≤–æ–∑–º–æ–∂–Ω–æ, –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω)" -ForegroundColor Yellow
}

Write-Host "`nüéâ –°–±–æ—Ä–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ!" -ForegroundColor Green
Write-Host "üìã –î–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:" -ForegroundColor Cyan
Write-Host "   - –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: src-tauri/target/release/yandex-music-client.exe" -ForegroundColor White
Write-Host "   - –£—Å—Ç–∞–Ω–æ–≤—â–∏–∫: src-tauri/target/release/bundle/msi/" -ForegroundColor White
Write-Host "   - –õ–æ–≥–∏: src-tauri/target/release/" -ForegroundColor White

Write-Host "`nüí° –°–æ–≤–µ—Ç—ã –ø–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é:" -ForegroundColor Cyan
Write-Host "   1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –∑–∞–≥—Ä—É–∑–∫—É –Ø–Ω–¥–µ–∫—Å –ú—É–∑—ã–∫–∏" -ForegroundColor White
Write-Host "   2. –ï—Å–ª–∏ –ø–æ—è–≤–ª—è–µ—Ç—Å—è –∫–Ω–æ–ø–∫–∞ '–ü–æ–ø—Ä–æ–±–æ–≤–∞—Ç—å —Å–Ω–æ–≤–∞', –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:" -ForegroundColor White
Write-Host "      - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –∏–Ω—Ç–µ—Ä–Ω–µ—Ç—É" -ForegroundColor White
Write-Host "      - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ –∞–Ω—Ç–∏–≤–∏—Ä—É—Å–∞/—Ñ–∞–π—Ä–≤–æ–ª–∞" -ForegroundColor White
Write-Host "      - –ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è" -ForegroundColor White
Write-Host "   3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å –±—Ä–∞—É–∑–µ—Ä–∞ (F12) –¥–ª—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–∏—Ö —Å–æ–æ–±—â–µ–Ω–∏–π" -ForegroundColor White

Write-Host "`nüîß –î–ª—è –∑–∞–ø—É—Å–∫–∞ –≤ —Ä–µ–∂–∏–º–µ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ: npm run tauri dev" -ForegroundColor Yellow
